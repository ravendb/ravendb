<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Fragment>
    <UI Id="InstallerUI">

      <UIRef Id="WixUI_InstallDir" />
      <UIRef Id="WixUI_ErrorProgressText" />

      <DialogRef Id="IisSetupDlg" />

      <Publish Dialog="LicenseAgreementDlg" Control="Next" Event="NewDialog" Value="InstallationType" Order="3">LicenseAccepted = "1"</Publish>

      <Publish Dialog="InstallationType" Control="Next" Event="NewDialog" Value="LicenseFileChooser">1</Publish>
      <Publish Dialog="InstallationType" Control="Back" Event="NewDialog" Value="LicenseAgreementDlg">1</Publish>
      <Publish Dialog="InstallationType" Control="Cancel" Event="SpawnDialog" Value="CancelDlg">1</Publish>

      <Publish Dialog="LicenseFileChooser" Control="Next" Event="NewDialog" Value="IisSetupDlg"><![CDATA[RAVEN_INSTALLATION_TYPE = "IIS" AND RAVEN_LICENSE_FILE_PATH <> "" AND LICENSE_FILE_EXISTS = "True"]]></Publish>
      <Publish Dialog="LicenseFileChooser" Control="Next" Event="NewDialog" Value="ServiceSettings"><![CDATA[RAVEN_INSTALLATION_TYPE = "SERVICE" AND RAVEN_LICENSE_FILE_PATH <> "" AND LICENSE_FILE_EXISTS = "True"]]></Publish>
      <Publish Dialog="LicenseFileChooser" Control="Back" Event="NewDialog" Value="InstallationType">1</Publish>
      <Publish Dialog="LicenseFileChooser" Control="Cancel" Event="SpawnDialog" Value="CancelDlg" Order="1">1</Publish>

      <Publish Dialog="ServiceSettings" Control="Next" Event="NewDialog" Value="InstallDirDlg"><![CDATA[SERVICE_NAME <> "" AND SERVICE_PORT <> ""]]></Publish>
      <Publish Dialog="ServiceSettings" Control="Back" Event="NewDialog" Value="LicenseFileChooser">1</Publish>
      <Publish Dialog="ServiceSettings" Control="Cancel" Event="SpawnDialog" Value="CancelDlg">1</Publish>

      <Publish Dialog="InstallDirDlg" Control="Back" Event="NewDialog" Value="ServiceSettings"><![CDATA[RAVEN_INSTALLATION_TYPE = "SERVICE"]]></Publish>
      <Publish Dialog="InstallDirDlg" Control="Back" Event="NewDialog" Value="PoolSettingsDlg"><![CDATA[RAVEN_INSTALLATION_TYPE = "IIS"]]></Publish>
    </UI>
  </Fragment>
</Wix>