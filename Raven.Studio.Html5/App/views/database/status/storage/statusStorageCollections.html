<section>

    <div class="panel panel-danger">
        <div class="panel-heading">
            <h3 class="panel-title">This operation is resource intensive!</h3>
        </div>
        <div class="panel-body">
            <p class="text-center">
                <button class="btn btn-danger" data-bind="click: fetchDocCounts, enable: canSearch"><i class="fa fa-spin fa-spinner" data-bind="visible: operationId"></i> Compute detailed storage breakdown</button>
                <button class="btn btn-danger" data-bind="click: cancelOperation, visible: operationId"><i class="fa fa-bolt"></i> Cancel</button>
            </p>

            <p class="text-center" data-bind="text: progress"></p>
        </div>
    </div>
    <div data-bind="with: data">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">General Data</h3>
            </div>
            <div class="panel-body">
                <div class="row">
                    <label class="col-md-5 text-right form-control-static">Time to generate</label>
                    <span class="col-md-5 form-control-static" data-bind="text: $root.formatTimeSpan(timeToGenerate)"></span>
                </div>
                <div class="row">
                    <label class="col-md-5 text-right form-control-static">Total Count</label>
                    <span class="col-md-5 form-control-static" data-bind="text: total"></span>
                </div>
                <div class="row">
                    <label class="col-md-5 text-right form-control-static">Total Size</label>
                    <span class="col-md-5 form-control-static" data-bind="text: $root.formatBytesToSize(totalSize)"></span>
                </div>
                <div class="row">
                    <label class="col-md-5 text-right form-control-static">Tombstones</label>
                    <span class="col-md-5 form-control-static" data-bind="text: tombstones"></span>
                </div>
            </div>
        </div>

        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Basic stats</h3>
            </div>
            <div class="panel-body">
                <table class="table table-condensed table-striped">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Amount</th>
                            <th>Size</th>
                            <th>Min</th>
                            <th>Max</th>
                            <th>Mean</th>
                            <th>Std dev.</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- ko foreach:collections -->
                        <tr>
                            <td data-bind="text: name"></td>
                            <td data-bind="text: stats.Counter"></td>
                            <td data-bind="text: $root.formatBytesToSize(size)"></td>
                            <td data-bind="text: $root.formatBytesToSize(stats.Min)"></td>
                            <td data-bind="text: $root.formatBytesToSize(stats.Max)"></td>
                            <td data-bind="text: $root.formatBytesToSize(stats.Mean)"></td>
                            <td data-bind="text: $root.formatBytesToSize(stats.Stdev)"></td>
                        </tr>
                        <!-- /ko -->
                        <tr data-bind="with: system">
                            <td>System</td>
                            <td data-bind="text: Stats.Counter"></td>
                            <td data-bind="text: $root.formatBytesToSize(TotalSize)"></td>
                            <td data-bind="text: $root.formatBytesToSize(Stats.Min)"></td>
                            <td data-bind="text: $root.formatBytesToSize(Stats.Max)"></td>
                            <td data-bind="text: $root.formatBytesToSize(Stats.Mean)"></td>
                            <td data-bind="text: $root.formatBytesToSize(Stats.Stdev)"></td>
                        </tr>
                        <tr data-bind="with: noCollection">
                            <td>No collection</td>
                            <td data-bind="text: Stats.Counter"></td>
                            <td data-bind="text: $root.formatBytesToSize(TotalSize)"></td>
                            <td data-bind="text: $root.formatBytesToSize(Stats.Min)"></td>
                            <td data-bind="text: $root.formatBytesToSize(Stats.Max)"></td>
                            <td data-bind="text: $root.formatBytesToSize(Stats.Mean)"></td>
                            <td data-bind="text: $root.formatBytesToSize(Stats.Stdev)"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Percentiles</h3>
            </div>
            <div class="panel-body">
                <table class="table table-condensed table-striped">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>50%</th>
                            <th>75%</th>
                            <th>95%</th>
                            <th>99%</th>
                            <th>99.9%</th>
                            <th>99.99%</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- ko foreach:collections -->
                        <tr>
                            <td data-bind="text: name"></td>
                            <td data-bind="text: $root.formatBytesToSize(stats.Percentiles['50%'])"></td>
                            <td data-bind="text: $root.formatBytesToSize(stats.Percentiles['75%'])"></td>
                            <td data-bind="text: $root.formatBytesToSize(stats.Percentiles['95%'])"></td>
                            <td data-bind="text: $root.formatBytesToSize(stats.Percentiles['99%'])"></td>
                            <td data-bind="text: $root.formatBytesToSize(stats.Percentiles['99.9%'])"></td>
                            <td data-bind="text: $root.formatBytesToSize(stats.Percentiles['99.99%'])"></td>
                        </tr>
                        <!-- /ko -->
                        <tr data-bind="with: system">
                            <td>System</td>
                            <td data-bind="text: $root.formatBytesToSize(Stats.Percentiles['50%'])"></td>
                            <td data-bind="text: $root.formatBytesToSize(Stats.Percentiles['75%'])"></td>
                            <td data-bind="text: $root.formatBytesToSize(Stats.Percentiles['95%'])"></td>
                            <td data-bind="text: $root.formatBytesToSize(Stats.Percentiles['99%'])"></td>
                            <td data-bind="text: $root.formatBytesToSize(Stats.Percentiles['99.9%'])"></td>
                            <td data-bind="text: $root.formatBytesToSize(Stats.Percentiles['99.99%'])"></td>
                        </tr>
                        <tr data-bind="with: noCollection">
                            <td>No collection</td>
                            <td data-bind="text: $root.formatBytesToSize(Stats.Percentiles['50%'])"></td>
                            <td data-bind="text: $root.formatBytesToSize(Stats.Percentiles['75%'])"></td>
                            <td data-bind="text: $root.formatBytesToSize(Stats.Percentiles['95%'])"></td>
                            <td data-bind="text: $root.formatBytesToSize(Stats.Percentiles['99%'])"></td>
                            <td data-bind="text: $root.formatBytesToSize(Stats.Percentiles['99.9%'])"></td>
                            <td data-bind="text: $root.formatBytesToSize(Stats.Percentiles['99.99%'])"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
         <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Top docs</h3>
            </div>
            <div class="panel-body">
                <table class="table table-condensed table-striped">
                    <thead>
                        <tr>
                            <th>Collection name</th>
                            <th>Document ID</th>
                            <th>Serialized Doc Size On Disk</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- ko foreach:collections -->
                        <!-- ko foreach:topDocs -->
                        <tr data-bind="css: { 'topBorder': $index() == 0 }">
                            <!-- ko if: $index() == 0 -->
                            <td style="background-color: white" data-bind="attr: { rowspan: $parent.topDocs.length }"><span data-bind="    text: $parent.name"></span></td>
                            <!-- /ko -->
                            <td data-bind="text: DocId"></td>
                            <td data-bind="text: Size"></td>
                        </tr>
                        <!-- /ko -->
                        <!-- /ko -->
                        <!-- /ko -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</section>
